          .IMPORT    goto_finish
          .IMPORT    dith64matrix
          .IMPORT    idx

          .EXPORT    put_1
          .EXPORT    put_2
          .EXPORT    put_3
          .EXPORT    put_4

          .MODULE put_1

T000000:   MOVEM.L   D3-D5/A2-A5,-(A7)
T000006:   MOVE.L    A0,A2
T000008:   MOVEA.L   $0028(A2),A3
T00000C:   MOVEA.L   $001C(A2),A4
T000010:   MOVEA.L   (A0),A5
T000012:   MOVE.L    $0018(A2),D3
T000016:   MOVE.L    D3,D0
T00001A:   MOVEA.L   $0010(A2),A0
T00001E:   MOVEQ.L   #-$80,D1
T000020:   CLR.W     D2
T000022:   MOVEQ.L   #$01,D4
T000024:   MOVEA.L   A0,A1
T000026:   MOVE.B    (A1),D5
T000028:   AND.B     D1,D5
T00002A:   BEQ.B     T00002E
T00002C:   OR.W      D4,D2
T00002E:   ADD.W     D4,D4
T000030:   ADDA.L    D3,A1
T000032:   CMPA.L    A1,A5
T000034:   BHI.B     T000026
T000036:   MOVE.B    (A5,D2.W),D4
T00003A:   CMP.B     (A4)+,D4
T00003C:   BGT.B     T000040
T00003E:   OR.B      D1,(A3)
T000040:   LSR.B     #1,D1
T000042:   BNE.B     T000020
T000044:   SUBQ.W    #8,A4
T000046:   ADDQ.W    #1,A3
T000048:   ADDQ.W    #1,A0
T00004A:   SUBQ.L    #1,D0
T00004C:   BNE.B     T00001E
T000050:   SUBQ.W    #1,$0022(A2)
T000056:   BLE       goto_finish
T00005A:   MOVEQ.L   #$01,D0
T00005C:   AND.L     D3,D0
T00005E:   ADDA.L    D0,A3
T000060:   ADDQ.W    #8,A4
T000062:   CMPA.L    #dith64matrix+$00000040,A4
T000068:   BNE.B     T000070
T00006A:   LEA.L     -$0040(A4),A4
T000070:   SUBQ.B    #1,$000E(A2)
T000074:   BNE.B     T000016
T000076:   ADDQ.B    #1,$000E(A2)
T00007A:   MOVE.L    A4,$001C(A2)
T00007E:   MOVE.L    A3,$0028(A2)
T000084:   MOVE.L    $0010(A2),(A2)
T000088:   MOVE.L    $0014(A2),$0004(A2)
T000090:   MOVEM.L   (A7)+,D3-D5/A2-A5
T000094:   RTS

          .ENDMOD

          .MODULE put_2

T000000:   MOVEM.L   D3-D6/A2-A5,-(A7)
T000006:   MOVEA.L   A0,A2
T000008:   MOVEA.L   $0028(A2),A3
T00000C:   MOVEA.L   $001C(A2),A4
T000010:   MOVEA.L   (A0),A5
T000012:   MOVE.L    $0018(A2),D3
T000016:   MOVE.L    $002C(A2),D4
T00001A:   MOVE.L    D3,D0
T00001C:   MOVE.L    $0010(A2),A1
T000020:   MOVEQ.L   #-$80,D1
T000022:   CLR.W     D2
T000024:   MOVEQ.L   #$04,D5
T000026:   MOVEA.L   A1,A0
T000028:   MOVE.B    (A0),D6
T00002A:   AND.B     D1,D6
T00002C:   BEQ.B     T000030
T00002E:   OR.W      D5,D2
T000030:   ADD.W     D5,D5
T000032:   ADDA.L    D3,A0
T000034:   CMPA.L    A0,A5
T000036:   BHI.B     T000028
T000038:   LEA.L     (A5,D2.W),A0
T00003C:   MOVE.B    (A4)+,D5
T00003E:   CLR.W     D2
T000040:   CMP.B     (A0)+,D5
T000042:   BGE.B     T000046
T000044:   ADDQ.W    #4,D2
T000046:   CMP.B     (A0)+,D5
T000048:   BGE.B     T00004C
T00004A:   ADDQ.W    #2,D2
T00004C:   CMP.B     (A0)+,D5
T00004E:   BGE.B     T000052
T000050:   ADDQ.W    #1,D2
T000052:   SUBQ.W    #7,D2
T000054:   BEQ.B     T000080
T000056:   MOVEA.L   A3,A0
T000058:   ADDQ.W    #7,D2
T00005A:   BNE.B     T00006A
T00005C:   MOVE.W    $0026(A2),D5
T000060:   OR.B      D1,(A0)
T000062:   ADDA.L    D4,A0
T000064:   SUBQ.W    #1,D5
T000066:   BGT.B     T000060
T000068:   BRA.B     T000080
T00006A:   LSL.B     #5,D2
T00006C:   BPL.B     T000070
T00006E:   OR.B      D1,(A0)
T000070:   ADDA.L    D4,A0
T000072:   ADD.B     D2,D2
T000074:   BPL.B     T000078
T000076:   OR.B      D1,(A0)
T000078:   ADD.B     D2,D2
T00007A:   BPL.B     T000080
T00007C:   OR.B      D1,(A0,D4.L)
T000080:   LSR.B     #1,D1
T000082:   BNE.B     T000022
T000084:   SUBQ.W    #8,A4
T000086:   ADDQ.W    #1,A3
T000088:   ADDQ.L    #1,A1
T00008A:   SUBQ.L    #1,D0
T00008C:   BNE       T000020
T000090:   SUBQ.W    #1,$0022(A2)
T000096:   BLE       goto_finish
T00009A:   MOVEQ.L   #$01,D0
T00009C:   AND.L     D3,D0
T00009E:   ADDA.L    D0,A3
T0000A0:   ADDQ.W    #8,A4
T0000A2:   CMPA.L    #dith64matrix+$00000040,A4
T0000A8:   BNE.B     T0000AE
T0000AA:   LEA.L     -$0040(A4),A4
T0000AE:   SUBQ.B    #1,$000E(A2)
T0000B2:   BNE       T00001A
T0000B6:   ADDQ.B    #1,$000E(A2)
T0000BA:   MOVE.L    A4,$001C(A2)
T0000BE:   MOVE.L    A3,$0028(A2)
T0000C2:   MOVE.L    $0010(A2),(A2)
T0000C6:   MOVE.L    $0014(A2),$0004(A2)
T0000CE:   MOVEM.L   (A7)+,D3-D6/A2-A5
T0000D2:   RTS

          .ENDMOD

          .MODULE put_3

T000000:   MOVEM.L   D3-D6/A2-A5,-(A7)
T000006:   MOVE.L    A0,A2
T000008:   MOVEA.L   $0028(A2),A3
T00000C:   MOVEA.L   $001C(A2),A4
T000010:   MOVEA.L   (A0),A5
T000012:   MOVE.L    $0018(A2),D3
T000016:   MOVE.L    $002C(A2),D4
T00001A:   MOVE.L    D3,D0
T00001E:   MOVEA.L   $0010(A2),A0
T000022:   MOVEQ.L   #-$80,D1
T000024:   CLR.W     D2
T000026:   MOVEQ.L   #$01,D5
T000028:   MOVEA.L   A0,A1
T00002A:   MOVE.B    (A1),D6
T00002C:   AND.B     D1,D6
T00002E:   BEQ.B     T000032
T000030:   OR.W      D5,D2
T000032:   ADD.W     D5,D5
T000034:   ADDA.L    D3,A1
T000036:   CMPA.L    A1,A5
T000038:   BHI.B     T00002A
T00003A:   MOVE.L    D4,D6
T00003C:   LSL.L     #3,D6
T00003E:   ADDA.L    D6,A3
T000040:   CLR.W     D5
T000042:   MOVE.B    (A5,D2.W),D5
T000046:   MOVE.W    D5,D6
T000048:   LSL.W     #2,D6
T00004A:   ADD.W     D6,D5
T00004C:   MOVEQ.L   #$3F,D6
T00004E:   AND.B     D5,D6
T000050:   CMP.B     (A4)+,D6
T000052:   BLE.B     T000058
T000054:   ADD.W     #$0040,D5
T000058:   ASR.W     #6,D5
T00005A:   SUBA.L    D4,A3
           BRA.B     T000062
idx:       DC.W      $204B, $76A1, $CCF7
T000062:   MOVE.B    idx(PC,D5.W),D2
T000066:   BPL.B     T00006A
T000068:   OR.B      D1,(A3)
T00006A:   SUBA.L    D4,A3
T00006C:   ADD.B     D2,D2
T00006E:   BPL.B     T000072
T000070:   OR.B      D1,(A3)
T000072:   SUBA.L    D4,A3
T000074:   ADD.B     D2,D2
T000076:   BPL.B     T00007A
T000078:   OR.B      D1,(A3)
T00007A:   SUBA.L    D4,A3
T00007C:   ADD.B     D2,D2
T00007E:   BPL.B     T000082
T000080:   OR.B      D1,(A3)
T000082:   SUBA.L    D4,A3
T000084:   ADD.B     D2,D2
T000086:   BPL.B     T00008A
T000088:   OR.B      D1,(A3)
T00008A:   SUBA.L    D4,A3
T00008C:   ADD.B     D2,D2
T00008E:   BPL.B     T000092
T000090:   OR.B      D1,(A3)
T000092:   SUBA.L    D4,A3
T000094:   ADD.B     D2,D2
T000096:   BPL.B     T00009A
T000098:   OR.B      D1,(A3)
T00009A:   SUBA.L    D4,A3
T00009C:   ADD.B     D2,D2
T00009E:   BPL.B     T0000A2
T0000A0:   OR.B      D1,(A3)
T0000A2:   LSR.B     #1,D1
T0000A4:   BNE       T000024
T0000A8:   SUBQ.W    #8,A4
T0000AA:   ADDQ.W    #1,A3
T0000AC:   ADDQ.W    #1,A0
T0000AE:   SUBQ.L    #1,D0
T0000B0:   BNE       T000022
T0000B6:   SUBQ.W    #1,$0022(A2)
T0000BC:   BLE       goto_finish
T0000C0:   MOVEQ.L   #$01,D0
T0000C2:   AND.L     D3,D0
T0000C4:   ADDA.L    D0,A3
T0000C6:   ADDQ.W    #8,A4
T0000C8:   CMPA.L    #dith64matrix+$00000040,A4
T0000CE:   BNE.B     T0000D6
T0000D0:   LEA.L     -$0040(A4),A4
T0000D6:   SUBQ.B    #1,$000E(A2)
T0000DA:   BNE       T00001A
T0000DE:   ADDQ.B    #1,$000E(A2)
T0000E2:   MOVE.L    A4,$001C(A2)
T0000E6:   MOVE.L    A3,$0028(A2)
T0000EC:   MOVE.L    $0010(A2),(A2)
T0000F0:   MOVE.L    $0014(A2),$0004(A2)
T0000F8:   MOVEM.L   (A7)+,D3-D6/A2-A5
T0000FC:   RTS

          .ENDMOD

          .MODULE put_4

T000000:   MOVEM.L   D3-D6/A2-A5,-(A7)
T000006:   MOVE.L    A0,A2
T000008:   MOVEA.L   $0028(A2),A3
T00000C:   MOVEA.L   $001C(A2),A4
T000010:   MOVEA.L   (A0),A5
T000012:   MOVE.L    $0018(A2),D3
T000016:   MOVE.L    $002C(A2),D4
T00001A:   MOVE.L    D3,D0
T00001E:   MOVEA.L   $0010(A2),A0
T000022:   MOVEQ.L   #-$80,D1
T000024:   CLR.W     D2
T000026:   MOVEQ.L   #$04,D5
T000028:   MOVEA.L   A0,A1
T00002A:   MOVE.B    (A1),D6
T00002C:   AND.B     D1,D6
T00002E:   BEQ.B     T000032
T000030:   OR.W      D5,D2
T000032:   ADD.W     D5,D5
T000034:   ADDA.L    D3,A1
T000036:   CMPA.L    A1,A5
T000038:   BHI.B     T00002A
T00003A:   LEA.L     (A5,D2.W),A1
T00003E:   CLR.W     D2
T000040:   MOVE.W    D2,D5
T000042:   MOVE.B    (A1)+,D5
T000044:   MOVE.W    D5,D6
T000046:   LSL.W     #2,D6
T000048:   ADD.W     D6,D5
T00004A:   MOVEQ.L   #$3F,D6
T00004C:   AND.B     D5,D6
T00004E:   CMP.B     (A4),D6
T000050:   BLE.B     T000054
T000052:   ADDQ.W    #1,D2
T000054:   ASR.W     #6,D5
T000056:   ADD.W     D5,D2
T000058:   MOVE.W    D2,D6
T00005A:   ADD.W     D6,D6
T00005C:   ADD.W     D6,D2
T00005E:   ADD.W     D2,D2
T000060:   MOVE.B    (A1)+,D5
T000062:   MOVE.W    D5,D6
T000064:   LSL.W     #2,D6
T000066:   ADD.W     D6,D5
T000068:   MOVEQ.L   #$3F,D6
T00006A:   AND.B     D5,D6
T00006C:   CMP.B     (A4),D6
T00006E:   BLE.B     T000072
T000070:   ADDQ.W    #1,D2
T000072:   ASR.W     #6,D5
T000074:   ADD.W     D5,D2
T000076:   MOVE.W    D2,D6
T000078:   ADD.W     D6,D6
T00007A:   ADD.W     D6,D2
T00007C:   ADD.W     D2,D2
T00007E:   MOVE.B    (A1)+,D5
T000080:   MOVE.W    D5,D6
T000082:   LSL.W     #2,D6
T000084:   ADD.W     D6,D5
T000086:   MOVEQ.L   #$3F,D6
T000088:   AND.B     D5,D6
T00008A:   CMP.B     (A4)+,D6
T00008C:   BLE.B     T000090
T00008E:   ADDQ.W    #1,D2
T000090:   ASR.W     #6,D5
T000092:   ADD.W     D5,D2
T000094:   MOVE.L    D4,D5
T000096:   LSL.L     #3,D5
T000098:   ADDA.L    D5,A3
T00009A:   SUBA.L    D4,A3
T00009C:   ADD.B     #$20,D2
T0000A0:   BPL.B     T0000A4
T0000A2:   OR.B      D1,(A3)
T0000A4:   SUBA.L    D4,A3
T0000A6:   ADD.B     D2,D2
T0000A8:   BPL.B     T0000AC
T0000AA:   OR.B      D1,(A3)
T0000AC:   SUBA.L    D4,A3
T0000AE:   ADD.B     D2,D2
T0000B0:   BPL.B     T0000B4
T0000B2:   OR.B      D1,(A3)
T0000B4:   SUBA.L    D4,A3
T0000B6:   ADD.B     D2,D2
T0000B8:   BPL.B     T0000BC
T0000BA:   OR.B      D1,(A3)
T0000BC:   SUBA.L    D4,A3
T0000BE:   ADD.B     D2,D2
T0000C0:   BPL.B     T0000C4
T0000C2:   OR.B      D1,(A3)
T0000C4:   SUBA.L    D4,A3
T0000C6:   ADD.B     D2,D2
T0000C8:   BPL.B     T0000CC
T0000CA:   OR.B      D1,(A3)
T0000CC:   SUBA.L    D4,A3
T0000CE:   ADD.B     D2,D2
T0000D0:   BPL.B     T0000D4
T0000D2:   OR.B      D1,(A3)
T0000D4:   SUBA.L    D4,A3
T0000D6:   ADD.B     D2,D2
T0000D8:   BPL.B     T0000DC
T0000DA:   OR.B      D1,(A3)
T0000DC:   LSR.B     #1,D1
T0000DE:   BNE       T000024
T0000E2:   SUBQ.W    #8,A4
T0000E4:   ADDQ.W    #1,A3
T0000E6:   ADDQ.W    #1,A0
T0000E8:   SUBQ.L    #1,D0
T0000EA:   BNE       T000022
T0000F0:   SUBQ.W    #1,$0022(A2)
T0000F6:   BLE       goto_finish
T0000FA:   MOVEQ.L   #$01,D0
T0000FC:   AND.L     D3,D0
T0000FE:   ADDA.L    D0,A3
T000100:   ADDQ.W    #8,A4
T000102:   CMPA.L    #dith64matrix+$00000040,A4
T000108:   BNE.B     T000110
T00010A:   LEA.L     -$0040(A4),A4
T000110:   SUBQ.B    #1,$000E(A2)
T000114:   BNE       T00001A
T000118:   ADDQ.B    #1,$000E(A2)
T00011C:   MOVE.L    A4,$001C(A2)
T000120:   MOVE.L    A3,$0028(A2)
T000126:   MOVE.L    $0010(A2),(A2)
T00012A:   MOVE.L    $0014(A2),$0004(A2)
T000132:   MOVEM.L   (A7)+,D3-D6/A2-A5
T000136:   RTS

          .ENDMOD
